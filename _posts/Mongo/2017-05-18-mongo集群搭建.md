---
layout: life
title: mongo集群搭建
category: Mongo
date: 2017-05-18
---

******

	作者: minus
	版本: V 0.0.1
	日期: 2017年05月18日
	mail: minus@stu.xjtu.edu.cn

<!-- more -->

*******

### Mongo集群架构
1. mongo基本情况及集群服务器情况
```
该mongo集群服务器一共使用8台服务器，其中6台服务器用来部署搭建shard /  config / arbiter 服务器，剩下两台服务器用来搭建mongos，以供外部应用连接
本集群使用的是mongo最新版本3.4, 其具有更强大的功能
```

2. 集群部署图
![mongo集群](/res/img/blog/mongo/mongo-cluster.png)

### 配置文件具体情况
1. mongo-shard服务器的配置文件内容
```sh
# for documentation of all options, see:
#   http://docs.mongodb.org/manual/reference/shard1uration-options/

# Where and how to store data.
storage:
   dbPath: /mongo-db/shard11/data
   journal:
      enabled: true
   engine: wiredTiger

systemLog:
  destination: file
  logAppend: false
  path: /mongo-db/shard11/log/mongod.log

processManagement:
  fork: true
  pidFilePath: /mongo-db/shard11/mongod.pid

net:
  port: 30000
  bindIp: mongo1

security:
  keyFile: /mongo-db/mongokey

sharding:
  clusterRole: shardsvr

replication:
  replSetName: replset1

setParameter:
  cursorTimeoutMillis: 12000000
```
2. mongo-arbiter服务器的配置文件内容
```sh
# for documentation of all options, see:
#   http://docs.mongodb.org/manual/reference/shard1uration-options/

# Where and how to store data.
storage:
   dbPath: /mongo-db/arbiter2/data
   journal:
      enabled: true
   engine: wiredTiger

systemLog:
  destination: file
  logAppend: false
  path: /mongo-db/arbiter2/log/mongod.log

processManagement:
  fork: true
  pidFilePath: /mongo-db/arbiter2/mongod.pid

net:
  port: 30002
  bindIp: mongo1

security:
  keyFile: /mongo-db/mongokey

sharding:
  clusterRole: shardsvr

replication:
  replSetName: replset2

setParameter:
  cursorTimeoutMillis: 12000000
```
3. mongo-config服务器的配置文件内容
```sh
# for documentation of all options, see:
#   http://docs.mongodb.org/manual/reference/shard1uration-options/

# Where and how to store data.
storage:
   dbPath: /mongo-db/config1/data
   journal:
      enabled: true
   engine: wiredTiger

systemLog:
  destination: file
  logAppend: false
  path: /mongo-db/config1/log/mongod.log

processManagement:
  fork: true
  pidFilePath: /mongo-db/config1/mongod.pid

net:
  port: 30001
  bindIp: mongo2

security:
  keyFile: /mongo-db/mongokey

sharding:
  clusterRole: configsvr

replication:
  replSetName: configreplset

setParameter:
  cursorTimeoutMillis: 12000000
```
