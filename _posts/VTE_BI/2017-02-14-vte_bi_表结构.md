---
layout: life
title: vte_bi表结构
category: VTE_BI
date: 2017-02-14
---

******

	作者: minus
	版本: V 0.0.1
	日期: 2017年1月27日

<!-- more -->

*******

### <font color="blue" style="font-weight:bold">CDR</font>

#### 基础表

| 表名                        | 索引列名           | 是否分片  | 片键   　　　 |            备注                         |
| -------------              |:-------------:    | :-----:  |  :----:      |   :-----------------------------------: ｜
| cdr_dic_mapping            | index             |  N       |              |                                         |


### <font color="blue" style="font-weight:bold">VTE</font>

#### 临时中间表及科研主表research

| 表名                         | 索引列名           | 是否分片  | 片键   |
| -------------                |:-------------:    | :-----:  |  ----: |
| research_id_temp             | index             |  N       |        |
| inpatient_case_temp          |                   |  N       |        |
| inpatient_mo_exec_drug_temp  |                   |  N       |        |
| inpatient_mo_exec_undrug_temp|                   |  N       |        |
| inpatient_diagnose_temp      |                   |  N       |        |
| inpatient_operation_temp     |                   |  N       |        |
| research [main_table]        |                   |  N       |        |

#### 建索引js语句
>
> research_id_temp
>
```
db.research_id_temp.createIndex({'index':1})
```
>
> research
>
```
db.research.createIndex({'pid':1})
db.research.createIndex({'in.date':1})
db.research.createIndex({'out.date':1})
```

### <font color="blue" style="font-weight:bold">BI</font>

#### bi所有产生的表

| 表名                         | 索引列名                                    | 是否分片  | 片键 |
| -------------                |:-------------:                            | :-----:  |  ----: |
| bed_stat                     | rpt_year rpt_month rpt_date rpt_quarter _id.dept_id pdept_id             |  N       |        |
| clinic_count                 | rpt_year rpt_month _id.rpt_date rpt_quarter _id.dept_id pdept_id         |  N       |        |
| clinic_feeinfo_stat          | rpt_year rpt_month _id.rpt_date rpt_quarter _id.doct_dept_id _id.doct_id |  N       |        |
| doctor_stat                  | rpt_year rpt_month rpt_quarter _id.doctor_id dept_id pdept_id            |  N       |        |
| inpatient_icd_age            | rpt_year rpt_month rpt_quarter _id.rpt_date _id.dept_id                  |  N       |        |
| inpatient_medicinelist_stat  | rpt_year rpt_month rpt_quarter _id.rpt_date _id.dept_id pdept_id         |  N       |        |
| inpatient_stat               | rpt_year rpt_month rpt_quarter _id.rpt_date _id.dept_id pdept_id        |  N       |        |
| inpatient_without_dept       | rpt_year rpt_month rpt_quarter _id.rpt_date _id.payment_type            |  N       |        |
| operation_dead_stat          | rpt_year rpt_month rpt_quarter _id.rpt_date _id.dept_id pdept_id        |  N       |        |
| operation_stat               | rpt_year rpt_month rpt_quarter _id.dept_id _id.rpt_date pdept_id        |  N       |        |

#### 建索引js语句
>
> bed_stat
>
```
db.bed_stat.createIndex({'rpt_date':1,'_id.dept_id':1})
db.bed_stat.createIndex({'rpt_month':1,'_id.dept_id':1})
db.bed_stat.createIndex({'rpt_quarter':1,'_id.dept_id':1})
db.bed_stat.createIndex({'rpt_year':1,'_id.dept_id':1})
```
>
> clinic_count
>
```
db.clinic_count.createIndex({'_id.rpt_date':1, '_id.dept_id':1})
db.clinic_count.createIndex({'rpt_month':1, '_id.dept_id':1})
db.clinic_count.createIndex({'rpt_quarter':1, '_id.dept_id':1})
db.clinic_count.createIndex({'rpt_year':1, '_id.dept_id':1})
```
>
> clinic_feeinfo_stat
>
```
db.clinic_feeinfo_stat.createIndex({'_id.rpt_date':1, '_id.doct_dept_id':1, '_id.doct_id':1})
db.clinic_feeinfo_stat.createIndex({'rpt_month':1, '_id.doct_dept_id':1, '_id.doct_id':1})
db.clinic_feeinfo_stat.createIndex({'rpt_quarter':1, '_id.doct_dept_id':1, '_id.doct_id':1})
db.clinic_feeinfo_stat.createIndex({'rpt_year':1, '_id.doct_dept_id':1, '_id.doct_id':1})
```
>备注: 里面有两个科室，　医生科室　和　门诊科室
>
> doctor_stat
>
```
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1})
>
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1, 'sum_med':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1, 'sum_med':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1, 'sum_med':1})
>
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1, 'sum_days':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1, 'sum_days':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1, 'sum_days':1})
>
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1, 'sum_tot':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1, 'sum_tot':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1, 'sum_tot':1})
>
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1, 'sum_mat':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1, 'sum_mat':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1, 'sum_mat':1})
>
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1, 'in_tot_fee':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1, 'in_tot_fee':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1, 'in_tot_fee':1})
>
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1, 'ce_tot_fee':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1, 'ce_tot_fee':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1, 'ce_tot_fee':1})
>
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1, 'cf_tot_fee':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1, 'cf_tot_fee':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1, 'cf_tot_fee':1})
>
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1, 'in_mat_fee':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1, 'in_mat_fee':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1, 'in_mat_fee':1})
>
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1, 'ce_mat_fee':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1, 'ce_mat_fee':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1, 'ce_mat_fee':1})
>
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1, 'cf_mat_fee':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1, 'cf_mat_fee':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1, 'cf_mat_fee':1})
>
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1, 'in_med_fee':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1, 'in_med_fee':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1, 'in_med_fee':1})
>
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1, 'ce_med_fee':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1, 'ce_med_fee':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1, 'ce_med_fee':1})
>
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1, 'cf_med_fee':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1, 'cf_med_fee':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1, 'cf_med_fee':1})
>
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1, 'mng1_count':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1, 'mng1_count':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1, 'mng1_count':1})
>
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1, 'mng2_count':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1, 'mng2_count':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1, 'mng2_count':1})
>
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1, 'mng3_count':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1, 'mng3_count':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1, 'mng3_count':1})
>
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1, 'clinic_count':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1, 'clinic_count':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1, 'clinic_count':1})
>
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1, 'in_days':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1, 'in_days':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1, 'in_days':1})
>
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1, 'ce_days':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1, 'ce_days':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1, 'ce_days':1})
>
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1, 'cf_days':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1, 'cf_days':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1, 'cf_days':1})
>
db.doctor_stat.createIndex({'rpt_year':1, 'dept_id':1 , '_id.doctor_id':1, 'surgery_count':1})
db.doctor_stat.createIndex({'rpt_month':1, 'dept_id':1 , '_id.doctor_id':1, 'surgery_count':1})
db.doctor_stat.createIndex({'rpt_quarter':1, 'dept_id':1 , '_id.doctor_id':1, 'surgery_count':1})
>
```
>
> inpatient_feeinfo_stat
>
```
db.inpatient_feeinfo_stat.createIndex({'rpt_year':1, '_id.dept_id':1, 'material_fee':1})
db.inpatient_feeinfo_stat.createIndex({'rpt_month':1, '_id.dept_id':1, 'material_fee':1})
db.inpatient_feeinfo_stat.createIndex({'rpt_quarter':1, '_id.dept_id':1, 'material_fee':1})
db.inpatient_feeinfo_stat.createIndex({'_id.rpt_date':1, '_id.dept_id':1, 'material_fee':1})
>
db.inpatient_feeinfo_stat.createIndex({'rpt_year':1, '_id.dept_id':1, 'total_fee':1})
db.inpatient_feeinfo_stat.createIndex({'rpt_month':1, '_id.dept_id':1, 'total_fee':1})
db.inpatient_feeinfo_stat.createIndex({'rpt_quarter':1, '_id.dept_id':1, 'total_fee':1})
db.inpatient_feeinfo_stat.createIndex({'_id.rpt_date':1, '_id.dept_id':1, 'total_fee':1})
>
db.inpatient_feeinfo_stat.createIndex({'rpt_year':1, '_id.dept_id':1, 'med_fee':1})
db.inpatient_feeinfo_stat.createIndex({'rpt_month':1, '_id.dept_id':1, 'med_fee':1})
db.inpatient_feeinfo_stat.createIndex({'rpt_quarter':1, '_id.dept_id':1, 'med_fee':1})
db.inpatient_feeinfo_stat.createIndex({'_id.rpt_date':1, '_id.dept_id':1, 'med_fee':1})
```
>
> inpatient_icd_age
> 
```
db.inpatient_icd_age.createIndex({'_id.rpt_date':1, '_id.dept_id':1, 'icd_type':1})
db.inpatient_icd_age.createIndex({'rpt_month':1, '_id.dept_id':1, 'icd_type':1})
db.inpatient_icd_age.createIndex({'rpt_quarter':1, '_id.dept_id':1, 'icd_type':1})
db.inpatient_icd_age.createIndex({'rpt_year':1, '_id.dept_id':1, 'icd_type':1})
```
>
> inpatient_medicinelist_stat
>
```
db.inpatient_medicinelist_stat.createIndex({'_id.rpt_date':1, '_id.dept_id':1, 'med_fee':1})
db.inpatient_medicinelist_stat.createIndex({'rpt_month':1, '_id.dept_id':1, 'med_fee':1})
db.inpatient_medicinelist_stat.createIndex({'rpt_quarter':1, '_id.dept_id':1, 'med_fee':1})
db.inpatient_medicinelist_stat.createIndex({'rpt_year':1, '_id.dept_id':1, 'med_fee':1})
db.inpatient_medicinelist_stat.createIndex({'_id.rpt_date':1, '_id.dept_id':1, 'total_fee':1})
db.inpatient_medicinelist_stat.createIndex({'rpt_month':1, '_id.dept_id':1, 'total_fee':1})
db.inpatient_medicinelist_stat.createIndex({'rpt_quarter':1, '_id.dept_id':1, 'total_fee':1})
db.inpatient_medicinelist_stat.createIndex({'rpt_year':1, '_id.dept_id':1, 'total_fee':1})
```
>
> inpatient_stat
>
```
db.inpatient_stat.createIndex({'_id.rpt_date':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'surgery_count':1})
db.inpatient_stat.createIndex({'_id.rpt_date':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'oper_patient_count':1})
db.inpatient_stat.createIndex({'_id.rpt_date':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'oper_count':1})
db.inpatient_stat.createIndex({'_id.rpt_date':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'before_oper_days':1})
db.inpatient_stat.createIndex({'_id.rpt_date':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'dead_count':1})
db.inpatient_stat.createIndex({'_id.rpt_date':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'gt30_count':1})
db.inpatient_stat.createIndex({'_id.rpt_date':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'count':1})
db.inpatient_stat.createIndex({'_id.rpt_date':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'days':1})
>
db.inpatient_stat.createIndex({'rpt_month':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'surgery_count':1})
db.inpatient_stat.createIndex({'rpt_month':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'oper_patient_count':1})
db.inpatient_stat.createIndex({'rpt_month':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'oper_count':1})
db.inpatient_stat.createIndex({'rpt_month':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'before_oper_days':1})
db.inpatient_stat.createIndex({'rpt_month':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'dead_count':1})
db.inpatient_stat.createIndex({'rpt_month':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'gt30_count':1})
db.inpatient_stat.createIndex({'rpt_month':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'count':1})
db.inpatient_stat.createIndex({'rpt_month':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'days':1})
>
db.inpatient_stat.createIndex({'rpt_quarter':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'surgery_count':1})
db.inpatient_stat.createIndex({'rpt_quarter':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'oper_patient_count':1})
db.inpatient_stat.createIndex({'rpt_quarter':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'oper_count':1})
db.inpatient_stat.createIndex({'rpt_quarter':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'before_oper_days':1})
db.inpatient_stat.createIndex({'rpt_quarter':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'dead_count':1})
db.inpatient_stat.createIndex({'rpt_quarter':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'gt30_count':1})
db.inpatient_stat.createIndex({'rpt_quarter':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'count':1})
db.inpatient_stat.createIndex({'rpt_quarter':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'days':1})
>
db.inpatient_stat.createIndex({'rpt_year':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'surgery_count':1})
db.inpatient_stat.createIndex({'rpt_year':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'oper_patient_count':1})
db.inpatient_stat.createIndex({'rpt_year':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'oper_count':1})
db.inpatient_stat.createIndex({'rpt_year':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'before_oper_days':1})
db.inpatient_stat.createIndex({'rpt_year':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'dead_count':1})
db.inpatient_stat.createIndex({'rpt_year':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'gt30_count':1})
db.inpatient_stat.createIndex({'rpt_year':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'count':1})
db.inpatient_stat.createIndex({'rpt_year':1, '_id.dept_id':1, 'patient_source':1, 'payment_type':1, 'days':1})
```
>
> inpatient_without_dept
>
```
db.inpatient_without_dept.createIndex({'_id.rpt_date':1, '_id.patient_souce':1, '_id.payment_type':1})
db.inpatient_without_dept.createIndex({'rpt_month':1, '_id.patient_souce':1, '_id.payment_type':1})
db.inpatient_without_dept.createIndex({'rpt_quarter':1, '_id.patient_souce':1, '_id.payment_type':1})
db.inpatient_without_dept.createIndex({'rpt_year':1, '_id.patient_souce':1, '_id.payment_type':1})
```
>
> operation_dead_stat
>
```
db.operation_dead_stat.createIndex({'_id.rpt_date':1, '_id.dept_id':1})
db.operation_dead_stat.createIndex({'rpt_month':1, '_id.dept_id':1})
db.operation_dead_stat.createIndex({'rpt_quarter':1, '_id.dept_id':1})
db.operation_dead_stat.createIndex({'rpt_year':1, '_id.dept_id':1})
```
>
> operation_stat
>
```
db.operation_stat.createIndex({'_id.rpt_date':1, '_id.dept_id':1})
db.operation_stat.createIndex({'rpt_month':1, '_id.dept_id':1})
db.operation_stat.createIndex({'rpt_quarter':1, '_id.dept_id':1})
db.operation_stat.createIndex({'rpt_year':1, '_id.dept_id':1})
```
